---
openapi: "PUT /v1/organizations/{organization_id}/users/{user_id}/roles"
---

## Integration Notes

1. **Role Management**: This endpoint specifically handles user role assignments within an organization.
2. **Complete Replacement**: The `access_roles` array completely replaces the user's current roles.
3. **Role Validation**: All roles must be valid system roles. Invalid roles will be rejected.
4. **Authorization**: Requires `update:user` scope to modify user roles.
6. **Request ID**: Always log the `requestId` for debugging support requests.

## Request

### Update User Roles

```json
{
  "access_roles": ["admin", "provider"]
}
```

### Assign Single Role

```json
{
  "access_roles": ["receptionist"]
}
```

### Request Fields

| Field          | Type     | Required | Description                               |
| -------------- | -------- | -------- | ----------------------------------------- |
| `access_roles` | string[] | Yes      | Array of roles to assign to the user     |

### Valid Roles

The following roles are supported in the Parchment system:

| Role                | Description                                    |
| ------------------- | ---------------------------------------------- |
| `admin`             | Administrator with extensive permissions       |
| `provider`          | Healthcare provider/prescriber                 |
| `receptionist`      | Front desk/reception staff                     |
| `rx_reader`         | Read-only access to prescriptions              |
| `rx_queue_manager`  | Manage prescription queues `coming soon`       |

### Validation Rules

1. **Required Field**: `access_roles` is required and must be an array
2. **Non-Empty Array**: `access_roles` must contain at least one role (cannot be empty)
3. **Valid Roles**: All roles must be from the supported roles list

## Response 

### Success Response (200 OK)

```json
{
  "success": true,
  "statusCode": 200,
  "message": "User roles updated successfully",
  "data": {
    "user_id": "usr_abc123def456",
    "access_roles": ["admin", "provider"]
  },
  "timestamp": "2024-01-15T10:30:00.000Z",
  "requestId": "req_1705312200000_abc123"
}
```

### Bad Request (400 Bad Request)

```json
{
    "success": false,
    "statusCode": 400,
    "error": {
        "type": "https://parchment.health/errors/invalid-request",
        "title": "Invalid request",
        "detail": "access_roles must be a non-empty array of valid roles"
    },
    "timestamp": "2025-08-24T08:41:50.042Z",
    "requestId": "1-68aad04d-10c08dde5682893b35b89265"
}
```

### User Not Found (404 Not Found)

```json
{
    "success": false,
    "statusCode": 404,
    "error": {
        "type": "https://parchment.health/errors/resource-not-found",
        "title": "Resource not found",
        "detail": "User not found"
    },
    "timestamp": "2025-08-24T08:43:28.294Z",
    "requestId": "1-68aad0b0-2f3757b01494507a7802998c"
}
```

## Response Fields

### Success Response Data

| Field          | Type     | Description                               |
| -------------- | -------- | ----------------------------------------- |
| `user_id`      | string   | Parchment's unique user identifier        |
| `access_roles` | string[] | Updated array of roles assigned to user  |

### Common Response Fields

All responses include these standard fields:

| Field        | Type    | Description                             |
| ------------ | ------- | --------------------------------------- |
| `success`    | boolean | Indicates if the request was successful |
| `statusCode` | number  | HTTP status code                        |
| `timestamp`  | string  | ISO 8601 timestamp of the response      |
| `requestId`  | string  | Unique identifier for debugging         |

## Status Codes

| Code  | Status                | Description                                      |
| ----- | --------------------- | ------------------------------------------------ |
| `200` | OK                    | User roles successfully updated                  |
| `400` | Bad Request           | Invalid request format or invalid parameters     |
| `401` | Unauthorized          | Authentication required or token invalid         |
| `403` | Forbidden             | Insufficient permissions (missing update:user scope) |
| `404` | Not Found             | User not found                                   |
| `409` | Conflict              | Role update conflict                             |
| `422` | Unprocessable Entity  | Request validation failed                        |
| `429` | Too Many Requests     | Rate limit exceeded                              |
| `500` | Internal Server Error | Unexpected server error                          |